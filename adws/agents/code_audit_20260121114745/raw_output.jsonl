{"type":"system","subtype":"init","cwd":"C:\\Users\\Split Lease\\Documents\\Split Lease\\adws","session_id":"89fa3960-4abe-4bb1-80c9-368fdaf7240c","tools":["Task","TaskOutput","Bash","Glob","Grep","ExitPlanMode","Read","Edit","Write","NotebookEdit","WebFetch","TodoWrite","WebSearch","KillShell","AskUserQuestion","Skill","EnterPlanMode","ToolSearch","mcp__playwright-host-live__browser_close","mcp__playwright-host-live__browser_resize","mcp__playwright-host-live__browser_console_messages","mcp__playwright-host-live__browser_handle_dialog","mcp__playwright-host-live__browser_evaluate","mcp__playwright-host-live__browser_file_upload","mcp__playwright-host-live__browser_fill_form","mcp__playwright-host-live__browser_install","mcp__playwright-host-live__browser_press_key","mcp__playwright-host-live__browser_type","mcp__playwright-host-live__browser_navigate","mcp__playwright-host-live__browser_navigate_back","mcp__playwright-host-live__browser_network_requests","mcp__playwright-host-live__browser_run_code","mcp__playwright-host-live__browser_take_screenshot","mcp__playwright-host-live__browser_snapshot","mcp__playwright-host-live__browser_click","mcp__playwright-host-live__browser_drag","mcp__playwright-host-live__browser_hover","mcp__playwright-host-live__browser_select_option","mcp__playwright-host-live__browser_tabs","mcp__playwright-host-live__browser_wait_for","mcp__playwright__browser_close","mcp__playwright__browser_resize","mcp__playwright__browser_console_messages","mcp__playwright__browser_handle_dialog","mcp__playwright__browser_evaluate","mcp__playwright__browser_file_upload","mcp__playwright__browser_fill_form","mcp__playwright__browser_install","mcp__playwright__browser_press_key","mcp__playwright__browser_type","mcp__playwright__browser_navigate","mcp__playwright__browser_navigate_back","mcp__playwright__browser_network_requests","mcp__playwright__browser_run_code","mcp__playwright__browser_take_screenshot","mcp__playwright__browser_snapshot","mcp__playwright__browser_click","mcp__playwright__browser_drag","mcp__playwright__browser_hover","mcp__playwright__browser_select_option","mcp__playwright__browser_tabs","mcp__playwright__browser_wait_for","mcp__shadcn__get_project_registries","mcp__shadcn__list_items_in_registries","mcp__shadcn__search_items_in_registries","mcp__shadcn__view_items_in_registries","mcp__shadcn__get_item_examples_from_registries","mcp__shadcn__get_add_command_for_items","mcp__shadcn__get_audit_checklist","ListMcpResourcesTool","ReadMcpResourceTool","mcp__playwright-guest-live__browser_close","mcp__playwright-guest-live__browser_resize","mcp__playwright-guest-live__browser_console_messages","mcp__playwright-guest-live__browser_handle_dialog","mcp__playwright-guest-live__browser_evaluate","mcp__playwright-guest-live__browser_file_upload","mcp__playwright-guest-live__browser_fill_form","mcp__playwright-guest-live__browser_install","mcp__playwright-guest-live__browser_press_key","mcp__playwright-guest-live__browser_type","mcp__playwright-guest-live__browser_navigate","mcp__playwright-guest-live__browser_navigate_back","mcp__playwright-guest-live__browser_network_requests","mcp__playwright-guest-live__browser_run_code","mcp__playwright-guest-live__browser_take_screenshot","mcp__playwright-guest-live__browser_snapshot","mcp__playwright-guest-live__browser_click","mcp__playwright-guest-live__browser_drag","mcp__playwright-guest-live__browser_hover","mcp__playwright-guest-live__browser_select_option","mcp__playwright-guest-live__browser_tabs","mcp__playwright-guest-live__browser_wait_for","mcp__playwright-guest-dev__browser_close","mcp__playwright-guest-dev__browser_resize","mcp__playwright-guest-dev__browser_console_messages","mcp__playwright-guest-dev__browser_handle_dialog","mcp__playwright-guest-dev__browser_evaluate","mcp__playwright-guest-dev__browser_file_upload","mcp__playwright-guest-dev__browser_fill_form","mcp__playwright-guest-dev__browser_install","mcp__playwright-guest-dev__browser_press_key","mcp__playwright-guest-dev__browser_type","mcp__playwright-guest-dev__browser_navigate","mcp__playwright-guest-dev__browser_navigate_back","mcp__playwright-guest-dev__browser_network_requests","mcp__playwright-guest-dev__browser_run_code","mcp__playwright-guest-dev__browser_take_screenshot","mcp__playwright-guest-dev__browser_snapshot","mcp__playwright-guest-dev__browser_click","mcp__playwright-guest-dev__browser_drag","mcp__playwright-guest-dev__browser_hover","mcp__playwright-guest-dev__browser_select_option","mcp__playwright-guest-dev__browser_tabs","mcp__playwright-guest-dev__browser_wait_for","mcp__playwright-host-dev__browser_close","mcp__playwright-host-dev__browser_resize","mcp__playwright-host-dev__browser_console_messages","mcp__playwright-host-dev__browser_handle_dialog","mcp__playwright-host-dev__browser_evaluate","mcp__playwright-host-dev__browser_file_upload","mcp__playwright-host-dev__browser_fill_form","mcp__playwright-host-dev__browser_install","mcp__playwright-host-dev__browser_press_key","mcp__playwright-host-dev__browser_type","mcp__playwright-host-dev__browser_navigate","mcp__playwright-host-dev__browser_navigate_back","mcp__playwright-host-dev__browser_network_requests","mcp__playwright-host-dev__browser_run_code","mcp__playwright-host-dev__browser_take_screenshot","mcp__playwright-host-dev__browser_snapshot","mcp__playwright-host-dev__browser_click","mcp__playwright-host-dev__browser_drag","mcp__playwright-host-dev__browser_hover","mcp__playwright-host-dev__browser_select_option","mcp__playwright-host-dev__browser_tabs","mcp__playwright-host-dev__browser_wait_for"],"mcp_servers":[{"name":"supabase-live","status":"needs-auth"},{"name":"supabase-dev","status":"needs-auth"},{"name":"supabase","status":"needs-auth"},{"name":"byterover-mcp","status":"needs-auth"},{"name":"playwright-host-live","status":"connected"},{"name":"playwright","status":"connected"},{"name":"shadcn","status":"connected"},{"name":"playwright-guest-live","status":"connected"},{"name":"playwright-guest-dev","status":"connected"},{"name":"playwright-host-dev","status":"connected"}],"model":"claude-opus-4-5-20251101","permissionMode":"bypassPermissions","slash_commands":["context-router","design-reverse-engineer","doc-maintainer","fp-rater","functional-code","goodbye-automated","playwrightTestGuideLoginInstructions","screenshot-to-slack","skill-creator","slack-webhook","vitest-rtl-setup","goodbye","track_agentic_kpis","tools","test_e2e","test","supabase","start","stage","splitlease","ship","review","resolve_failed_test","resolve_failed_e2e_test","pull_request","prime","preview","prepare_app","patch","in_loop_review","invoke-claude-chrome","install_worktree","install","implement","health_check","goodbye","generate_claude","generate_branch_name","functions","functions-dev","feature","document","dev","deploy","conditional_docs","commit","cleanup_worktrees","claude_browser","classify_issue","classify_adw","chore","bug","audit_silent_passes","compact","context","cost","init","pr-comments","release-notes","review","security-review"],"apiKeySource":"none","claude_code_version":"2.1.14","output_style":"default","agents":["Bash","general-purpose","statusline-setup","Explore","Plan","claude-code-guide","debug-analyst","context-lookup","cleanup-planner","input-reviewer","implementation-planner","task-classifier","plan-executor","design-planner"],"skills":["context-router","design-reverse-engineer","doc-maintainer","fp-rater","functional-code","screenshot-to-slack","skill-creator","slack-webhook","vitest-rtl-setup"],"plugins":[],"uuid":"52609785-559d-4134-86f2-943b60713d54"}
{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_011Mqsj5HKYNoHxjdRahUV6E","type":"message","role":"assistant","content":[{"type":"text","text":"I'll start by understanding the codebase structure, focusing on the `../app` directory. Let me first read the CLAUDE.md files and then get the git file listing."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":56822,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":56822,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"89fa3960-4abe-4bb1-80c9-368fdaf7240c","uuid":"f6816ad0-719b-4818-ae66-0610450f0b7d"}
{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_011Mqsj5HKYNoHxjdRahUV6E","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0143jyckhNvnyGQui5KooV9P","name":"Read","input":{"file_path":"C:\\Users\\Split Lease\\Documents\\Split Lease\\app\\CLAUDE.md"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":56822,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":56822,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"89fa3960-4abe-4bb1-80c9-368fdaf7240c","uuid":"78b1dc4d-caed-4132-94a9-2c46d947ea40"}
{"type":"assistant","message":{"model":"claude-opus-4-5-20251101","id":"msg_011Mqsj5HKYNoHxjdRahUV6E","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Mxn61rRFLyPtAoZWKf3eTA","name":"Bash","input":{"command":"cd \"C:/Users/Split Lease/Documents/Split Lease\" && git ls-files -- app/ | head -200","description":"List git-tracked files in app directory"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":56822,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":56822,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"},"context_management":null},"parent_tool_use_id":null,"session_id":"89fa3960-4abe-4bb1-80c9-368fdaf7240c","uuid":"b66b8b92-3ed5-445e-9bb4-8a834584209f"}
{"type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0143jyckhNvnyGQui5KooV9P","type":"tool_result","content":"     1→# App Directory - LLM Reference\n     2→\n     3→**GENERATED**: 2025-12-11\n     4→**SCOPE**: Frontend application root - Configuration, build tools, static assets, entry points\n     5→**OPTIMIZATION**: Semantic Searchability + Digestibility\n     6→\n     7→---\n     8→\n     9→## QUICK_STATS\n    10→\n    11→[TOTAL_ROOT_FILES]: 9\n    12→[TOTAL_SUBDIRECTORIES]: 6\n    13→[PRIMARY_LANGUAGE]: JavaScript/TypeScript (React 18)\n    14→[BUILD_TOOL]: Vite 5.0\n    15→[ARCHITECTURE]: Islands Architecture\n    16→[DEPLOYMENT]: Cloudflare Pages\n    17→[KEY_PATTERNS]: Multi-page app, Route Registry, Islands pattern, ESM modules\n    18→\n    19→---\n    20→\n    21→## ROOT_FILES\n    22→\n    23→### package.json\n    24→[INTENT]: NPM package configuration and dependency management\n    25→[TYPE]: ESM module (type: \"module\")\n    26→[SCRIPTS]: dev (port 8000), build, preview, generate-routes, prebuild\n    27→[DEPENDENCIES]: React 18, Supabase client, Google Maps React, date-fns, framer-motion, react-hook-form, zod, styled-components\n    28→[DEV_DEPENDENCIES]: Vite 5, @vitejs/plugin-react, esbuild, supabase CLI\n    29→[RUNTIME]: Bun preferred, Node compatible\n    30→\n    31→### vite.config.js\n    32→[INTENT]: Vite bundler configuration for multi-page React application\n    33→[PLUGINS]: @vitejs/plugin-react, multi-page-routing middleware, move-html-to-root post-build\n    34→[ROUTING_LOGIC]: Shared routing function for dev and preview servers using Route Registry\n    35→[BUILD_INPUT]: 27 HTML entry points from public/ directory\n    36→[BUILD_OUTPUT]: dist/ with HTML at root, assets in dist/assets/\n    37→[DEV_SERVER]: Port 8000, localhost + 127.0.0.1, /api proxy to wrangler (port 8788)\n    38→[PREVIEW_SERVER]: Port 8000, 127.0.0.1\n    39→[POST_BUILD_TASKS]: Move HTML to dist root, copy assets/, copy _redirects, copy _headers, copy _routes.json, create _internal/ files, copy images/, copy help-center-articles/, copy functions/\n    40→[IMPORTS]: routes, getInternalRoutes, getBasePath, buildRollupInputs from src/routes.config.js\n    41→\n    42→### tsconfig.json\n    43→[INTENT]: TypeScript compiler configuration for React app\n    44→[TARGET]: ES2020\n    45→[MODULE]: ESNext\n    46→[JSX]: react-jsx\n    47→[MODE]: Bundler mode resolution\n    48→[STRICT]: Disabled (strict: false)\n    49→[INCLUDE]: src directory\n    50→[ALLOW_JS]: true\n    51→[NO_EMIT]: true (type checking only, Vite handles compilation)\n    52→\n    53→### tsconfig.node.json\n    54→[INTENT]: TypeScript configuration for Node.js scripts\n    55→[COMPOSITE]: true\n    56→[MODULE]: ESNext\n    57→[INCLUDE]: vite.config.js\n    58→\n    59→### .env.example\n    60→[INTENT]: Environment variable template for local development\n    61→[REQUIRED_VARS]: VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY, VITE_GOOGLE_MAPS_API_KEY\n    62→[OPTIONAL_VARS]: SLACK_WEBHOOK_ACQUISITION, SLACK_WEBHOOK_GENERAL\n    63→[REMOVED_VARS]: VITE_BUBBLE_API_BASE_URL, VITE_BUBBLE_API_KEY (migrated to Edge Functions)\n    64→[SECURITY_NOTE]: Bubble API keys now stored server-side in Supabase Secrets\n    65→\n    66→### .gitignore\n    67→[INTENT]: Git ignore patterns\n    68→[IGNORED]: node_modules/, dist/, .env, .env.local, *.log, .DS_Store, ../input\n    69→\n    70→### bun.lock\n    71→[INTENT]: Bun package manager lockfile\n    72→[PURPOSE]: Reproducible dependency installation\n    73→\n    74→### .gitkeep-functions\n    75→[INTENT]: Placeholder to keep functions directory in git\n    76→\n    77→---\n    78→\n    79→## SUBDIRECTORIES\n    80→\n    81→### src/\n    82→[INTENT]: React application source code\n    83→[CONTAINS]: Entry points (*.jsx), islands/, lib/, logic/, styles/, routes/, config/, data/\n    84→[ARCHITECTURE]: Islands Architecture with hollow components\n    85→[DOCUMENTATION]: C:\\Users\\Split Lease\\Documents\\Split Lease\\app\\src\\CLAUDE.md\n    86→[ENTRY_POINTS]: 27 JSX files that mount React components to HTML pages\n    87→[KEY_SUBDIRS]: islands/ (React components), lib/ (utilities + API clients), logic/ (4-layer business logic), styles/ (CSS)\n    88→\n    89→### public/\n    90→[INTENT]: Static assets and HTML templates for multi-page app\n    91→[CONTAINS]: HTML files, assets/, images/, help-center-articles/, _redirects, _headers, _routes.json\n    92→[HTML_FILES]: 27 files (index.html, search.html, view-split-lease.html, etc.)\n    93→[DEPLOYMENT_FILES]: _redirects (Cloudflare routing), _headers (HTTP headers), _routes.json (Functions control)\n    94→[GENERATED_FILES]: _redirects and _routes.json are auto-generated by scripts/generate-redirects.js\n    95→[COPY_BEHAVIOR]: Assets copied to dist/ during build, HTML files moved to dist root\n    96→\n    97→### public/assets/\n    98→[INTENT]: Static media assets\n    99→[SUBDIRS]: fonts/, games/, icons/, images/, lotties/, resources/, videos/\n   100→[USAGE]: Referenced via /assets/ path in HTML/CSS\n   101→\n   102→### public/images/\n   103→[INTENT]: Public image files\n   104→[CONTAINS]: support-centre-icon.svg\n   105→[USAGE]: Referenced via /images/ path\n   106→\n   107→### public/help-center-articles/\n   108→[INTENT]: Static HTML help articles\n   109→[USAGE]: Served directly by Cloudflare Pages\n   110→\n   111→### scripts/\n   112→[INTENT]: Build and development scripts\n   113→[FILES]: generate-redirects.js\n   114→[USAGE]: Executed via npm/bun scripts (prebuild hook)\n   115→\n   116→### functions/\n   117→[INTENT]: Cloudflare Pages Functions (API routes)\n   118→[SUBDIRS]: api/\n   119→[FILES]: api/faq-inquiry.js\n   120→[DEPLOYMENT]: Automatically deployed to /api/* routes on Cloudflare Pages\n   121→[NOTE]: Most backend logic now uses Supabase Edge Functions, not Cloudflare Functions\n   122→\n   123→### functions/api/\n   124→[INTENT]: Cloudflare Pages API endpoints\n   125→[FILES]: faq-inquiry.js, CLAUDE.md\n   126→[ROUTES]: /api/faq-inquiry\n   127→[STATUS]: Deprecated in favor of Supabase Edge Functions\n   128→\n   129→### dist/\n   130→[INTENT]: Production build output (generated, not in git)\n   131→[STRUCTURE]: HTML at root, assets/ subdir, _internal/ subdir, functions/ copy\n   132→[CREATED_BY]: vite build command\n   133→[DEPLOYMENT_TARGET]: Cloudflare Pages\n   134→\n   135→---\n   136→\n   137→## ROUTING_SYSTEM\n   138→\n   139→### src/routes.config.js\n   140→[INTENT]: Single source of truth for all application routes\n   141→[EXPORTS]: routes array, apiRoutes, excludedFromFunctions, getInternalRoutes(), getBasePath(), matchRoute(), findRouteForUrl(), buildRollupInputs()\n   142→[ROUTE_COUNT]: 27 routes\n   143→[ROUTE_TYPES]: Static pages, dynamic routes (:id, :userId, :category), protected routes, dev-only routes\n   144→[DYNAMIC_ROUTES]: /view-split-lease/:id, /preview-split-lease/:id, /guest-proposals/:userId, /account-profile/:userId, /host-proposals/:userId, /help-center/:category\n   145→[PROTECTED_ROUTES]: /preview-split-lease, /guest-proposals, /account-profile, /host-proposals, /self-listing, /listing-dashboard, /host-overview, /favorite-listings, /rental-application\n   146→[CLOUDFLARE_INTERNAL]: Routes using _internal/ directory to avoid 308 redirects\n   147→[USAGE]: Consumed by vite.config.js, scripts/generate-redirects.js\n   148→\n   149→### scripts/generate-redirects.js\n   150→[INTENT]: Generate Cloudflare Pages routing files from Route Registry\n   151→[EXECUTION]: prebuild hook (bun run generate-routes)\n   152→[GENERATES]: public/_redirects, public/_routes.json\n   153→[INPUT]: src/routes.config.js\n   154→[VALIDATION]: Checks for duplicate paths, missing fields, cloudflareInternal consistency\n   155→[OUTPUT_FORMAT]: _redirects (Cloudflare rewrite syntax), _routes.json (Functions control)\n   156→\n   157→### public/_redirects\n   158→[INTENT]: Cloudflare Pages routing configuration\n   159→[GENERATED_BY]: scripts/generate-redirects.js\n   160→[SYNTAX]: Cloudflare Pages redirects format\n   161→[PATTERN]: path /_internal/name 200 OR path /file.html 200\n   162→[DYNAMIC_HANDLING]: Use _internal/ files to prevent Cloudflare's 308 redirects\n   163→[AUTO_GENERATED]: DO NOT EDIT MANUALLY\n   164→\n   165→### public/_routes.json\n   166→[INTENT]: Control which routes use Cloudflare Functions\n   167→[GENERATED_BY]: scripts/generate-redirects.js\n   168→[INCLUDE]: /api/* (Cloudflare Functions)\n   169→[EXCLUDE]: /guest-proposals, /guest-proposals/*, /host-proposals, /host-proposals/*\n   170→[VERSION]: 1\n   171→\n   172→---\n   173→\n   174→## BUILD_PROCESS\n   175→\n   176→### Development\n   177→[COMMAND]: bun run dev\n   178→[PORT]: 8000\n   179→[SERVER]: Vite dev server with HMR\n   180→[MIDDLEWARE]: Multi-page routing middleware using Route Registry\n   181→[PUBLIC_PREFIX]: /public (proxied to public/ directory)\n   182→[API_PROXY]: /api/* proxied to localhost:8788 (wrangler)\n   183→\n   184→### Production Build\n   185→[COMMAND]: bun run build\n   186→[STEPS]: 1) Prebuild (generate routes), 2) Vite build, 3) Post-build (move HTML, copy assets)\n   187→[OUTPUT]: dist/ directory\n   188→[HTML_LOCATION]: dist root (e.g., dist/index.html)\n   189→[ASSETS_LOCATION]: dist/assets/ with hashed filenames\n   190→[INTERNAL_FILES]: dist/_internal/ (copies of HTML files for Cloudflare routing)\n   191→[COPIED_DIRS]: assets/, images/, help-center-articles/, functions/\n   192→[COPIED_FILES]: _redirects, _headers, _routes.json\n   193→\n   194→### Preview\n   195→[COMMAND]: bun run preview\n   196→[PORT]: 8000\n   197→[SERVER]: Vite preview server (serves dist/)\n   198→[MIDDLEWARE]: Multi-page routing middleware using Route Registry\n   199→[PUBLIC_PREFIX]: Empty string (serves from dist root)\n   200→\n   201→---\n   202→\n   203→## DEPLOYMENT\n   204→\n   205→### Platform\n   206→[TARGET]: Cloudflare Pages\n   207→[BUILD_COMMAND]: bun run build\n   208→[OUTPUT_DIR]: dist\n   209→[NODE_VERSION]: 18 or higher\n   210→[FRAMEWORK_PRESET]: None (custom Vite config)\n   211→\n   212→### Routing Strategy\n   213→[METHOD]: Cloudflare _redirects file + _internal directory\n   214→[WHY_INTERNAL]: Avoid Cloudflare's \"pretty URL\" 308 redirects that strip query params/hash\n   215→[DYNAMIC_ROUTES]: Rewrite to _internal/route-name files\n   216→[STATIC_ROUTES]: Some use _internal/, some direct to .html\n   217→\n   218→### Functions\n   219→[CLOUDFLARE_FUNCTIONS]: /api/* (legacy, deprecated)\n   220→[SUPABASE_EDGE_FUNCTIONS]: Preferred for all backend logic\n   221→[EXCLUDED_ROUTES]: /guest-proposals/*, /host-proposals/* (no Functions processing)\n   222→\n   223→---\n   224→\n   225→## ENTRY_POINTS\n   226→\n   227→### HTML Templates (public/*.html)\n   228→[COUNT]: 27 files\n   229→[PURPOSE]: Shell pages that load React apps\n   230→[PATTERN]: <div id=\"root\"></div> + <script type=\"module\" src=\"/src/ENTRY.jsx\"></script>\n   231→[BUILD_BEHAVIOR]: Vite processes, outputs to dist root with hashed asset references\n   232→\n   233→### React Entry Points (src/*.jsx)\n   234→[COUNT]: 27 files\n   235→[PATTERN]: Import page component, createRoot, render to #root\n   236→[EXAMPLES]: main.jsx → HomePage, search.jsx → SearchPage, view-split-lease.jsx → ViewSplitLeasePage\n   237→\n   238→### Entry Point Mapping\n   239→[HOMEPAGE]: index.html ← src/main.jsx ← HomePage\n   240→[SEARCH]: search.html ← src/search.jsx ← SearchPage\n   241→[LISTING_VIEW]: view-split-lease.html ← src/view-split-lease.jsx ← ViewSplitLeasePage\n   242→[LISTING_PREVIEW]: preview-split-lease.html ← src/preview-split-lease.jsx ← PreviewSplitLeasePage\n   243→[GUEST_PROPOSALS]: guest-proposals.html ← src/guest-proposals.jsx ← GuestProposalsPage\n   244→[HOST_PROPOSALS]: host-proposals.html ← src/host-proposals.jsx ← HostProposalsPage\n   245→[SELF_LISTING]: self-listing.html ← src/self-listing.jsx ← SelfListingPage\n   246→[SELF_LISTING_V2]: self-listing-v2.html ← src/self-listing-v2.jsx ← SelfListingPageV2\n   247→[LISTING_DASHBOARD]: listing-dashboard.html ← src/listing-dashboard.jsx ← ListingDashboardPage\n   248→[HOST_OVERVIEW]: host-overview.html ← src/host-overview.jsx ← HostOverviewPage\n   249→[ACCOUNT_PROFILE]: account-profile.html ← src/account-profile.jsx ← AccountProfilePage\n   250→[FAQ]: faq.html ← src/faq.jsx ← FAQPage\n   251→[HELP_CENTER]: help-center.html ← src/help-center.jsx ← HelpCenterPage\n   252→[HELP_CATEGORY]: help-center-category.html ← src/help-center-category.jsx ← HelpCenterCategoryPage\n   253→[POLICIES]: policies.html ← src/policies.jsx ← PoliciesPage\n   254→[CAREERS]: careers.html ← src/careers.jsx ← CareersPage\n   255→[ABOUT_US]: about-us.html ← src/about-us.jsx ← AboutUsPage\n   256→[LIST_WITH_US]: list-with-us.html ← src/list-with-us.jsx ← ListWithUsPage\n   257→[WHY_SPLIT_LEASE]: why-split-lease.html ← src/why-split-lease.jsx ← WhySplitLeasePage\n   258→[GUEST_SUCCESS]: guest-success.html ← src/guest-success.jsx ← GuestSuccessPage\n   259→[HOST_SUCCESS]: host-success.html ← src/host-success.jsx ← HostSuccessPage\n   260→[FAVORITE_LISTINGS]: favorite-listings.html ← src/favorite-listings.jsx ← FavoriteListingsPage\n   261→[RENTAL_APPLICATION]: rental-application.html ← src/rental-application.jsx ← RentalApplicationPage\n   262→[RESET_PASSWORD]: reset-password.html ← src/reset-password.jsx ← ResetPasswordPage\n   263→[NOT_FOUND]: 404.html ← src/404.jsx ← NotFoundPage\n   264→[SEARCH_TEST]: search-test.html ← src/search-test.jsx ← SearchPageTest\n   265→[INTERNAL_TEST]: _internal-test.html ← src/_internal-test.jsx ← InternalTestPage\n   266→\n   267→---\n   268→\n   269→## ARCHITECTURE_PATTERNS\n   270→\n   271→### Islands Architecture\n   272→[DESCRIPTION]: Each HTML page is an independent React root\n   273→[BENEFIT]: No shared state between pages, simpler mental model\n   274→[NAVIGATION]: Full page loads (no client-side routing)\n   275→[STATE_PERSISTENCE]: URL params, localStorage, Supabase database\n   276→\n   277→### Route Registry Pattern\n   278→[DESCRIPTION]: Single source of truth for all routes in src/routes.config.js\n   279→[CONSUMERS]: Vite dev server, Vite preview, Cloudflare _redirects, Vite build inputs\n   280→[BENEFIT]: Change route once, updates everywhere\n   281→[VALIDATION]: Automated checks in generate-redirects.js\n   282→\n   283→### Cloudflare _internal Pattern\n   284→[DESCRIPTION]: Copy HTML files to dist/_internal/ with custom names\n   285→[WHY]: Avoid Cloudflare's automatic 308 redirects that strip query params/hash\n   286→[USAGE]: Dynamic routes and pages needing query/hash preservation\n   287→[EXAMPLE]: /search → /_internal/search-view\n   288→\n   289→### Hollow Component Pattern\n   290→[DESCRIPTION]: Page components delegate all logic to custom hooks\n   291→[BENEFIT]: Testable business logic, focused UI components\n   292→[LOCATION]: src/islands/pages/\n   293→[EXAMPLE]: ViewSplitLeasePage.jsx (UI only) + useViewSplitLeasePageLogic.js (logic)\n   294→\n   295→### Four-Layer Logic Architecture\n   296→[DESCRIPTION]: Business logic separated into calculators, rules, processors, workflows\n   297→[LOCATION]: src/logic/\n   298→[LAYER_1]: Calculators (pure math functions: calculate*, get*)\n   299→[LAYER_2]: Rules (boolean predicates: can*, is*, has*, should*)\n   300→[LAYER_3]: Processors (data transformation: adapt*, extract*, process*, format*)\n   301→[LAYER_4]: Workflows (orchestration: *Workflow)\n   302→[BENEFIT]: Reusable, testable, maintainable business logic\n   303→\n   304→---\n   305→\n   306→## ENVIRONMENT_VARIABLES\n   307→\n   308→### Frontend (VITE_ prefix)\n   309→[VITE_SUPABASE_URL]: Supabase project URL (from Supabase dashboard)\n   310→[VITE_SUPABASE_ANON_KEY]: Supabase anonymous key (public, safe for client)\n   311→[VITE_GOOGLE_MAPS_API_KEY]: Google Maps JavaScript API key\n   312→\n   313→### Backend (Supabase Secrets)\n   314→[BUBBLE_API_BASE_URL]: Bubble.io API endpoint (legacy backend)\n   315→[BUBBLE_API_KEY]: Bubble.io API authentication\n   316→[OPENAI_API_KEY]: OpenAI API for AI features\n   317→[SUPABASE_SERVICE_ROLE_KEY]: Supabase admin key (server-side only)\n   318→\n   319→### Configuration Location\n   320→[FRONTEND_ENV]: app/.env (local), Cloudflare Pages settings (production)\n   321→[BACKEND_SECRETS]: Supabase Dashboard → Project Settings → Edge Functions Secrets\n   322→[SECURITY]: Never expose Bubble/OpenAI keys in frontend code\n   323→\n   324→---\n   325→\n   326→## CRITICAL_CONVENTIONS\n   327→\n   328→### Day Indexing\n   329→[JS_FORMAT]: 0-6 (Sunday=0, Monday=1, ..., Saturday=6)\n   330→[BUBBLE_FORMAT]: 1-7 (Sunday=1, Monday=2, ..., Saturday=7)\n   331→[CONVERSION_FUNCTIONS]: adaptDaysFromBubble(), adaptDaysToBubble()\n   332→[LOCATION]: src/logic/processors/external/\n   333→[RULE]: Always convert at API boundaries, never mix formats\n   334→\n   335→### Unique ID Generation\n   336→[METHOD]: Supabase RPC function generate_bubble_id\n   337→[USAGE]: const { data: newId } = await supabaseAdmin.rpc('generate_bubble_id')\n   338→[FORMAT]: 17-character alphanumeric string (Bubble-compatible)\n   339→\n   340→### API Architecture\n   341→[FRONTEND_TO_BACKEND]: Frontend → Supabase Edge Functions → Bubble API\n   342→[DIRECT_SUPABASE]: Frontend → Supabase Database (for Supabase-native tables)\n   343→[NEVER]: Frontend → Bubble API directly (security violation)\n   344→\n   345→---\n   346→\n   347→## DO_RULES\n   348→\n   349→[DO_USE_ROUTE_REGISTRY]: Always update src/routes.config.js for route changes\n   350→[DO_GENERATE_ROUTES]: Run bun run generate-routes after route config changes\n   351→[DO_USE_EDGE_FUNCTIONS]: Proxy all Bubble API calls through Supabase Edge Functions\n   352→[DO_STORE_SECRETS]: Keep API keys in Supabase Secrets, never in frontend\n   353→[DO_COMMIT_CHANGES]: Git commit after each logical change (per project instructions)\n   354→[DO_USE_ESM]: Use ES modules (import/export), not CommonJS\n   355→[DO_USE_BUN]: Prefer bun for package management and script execution\n   356→[DO_USE_HOLLOW_PATTERN]: Keep page components minimal, delegate logic to hooks\n   357→[DO_USE_FOUR_LAYERS]: Organize business logic into calculators/rules/processors/workflows\n   358→[DO_CONVERT_DAYS]: Use adaptDaysFromBubble/adaptDaysToBubble at API boundaries\n   359→\n   360→---\n   361→\n   362→## DONT_RULES\n   363→\n   364→[DONT_EDIT_GENERATED]: Never manually edit _redirects or _routes.json (auto-generated)\n   365→[DONT_EXPOSE_KEYS]: Never put Bubble/OpenAI API keys in frontend code or .env\n   366→[DONT_SKIP_VALIDATION]: Always run generate-redirects.js validation before deploying\n   367→[DONT_CALL_BUBBLE_DIRECTLY]: Never call Bubble API from frontend (security risk)\n   368→[DONT_MIX_DAY_FORMATS]: Never use 0-based and 1-based days in same function\n   369→[DONT_PUSH_FORCE]: Never git push --force to main/master\n   370→[DONT_ADD_FALLBACKS]: No fallback mechanisms when encountering errors (per project philosophy)\n   371→[DONT_OVER_ENGINEER]: Match solution to actual scale, not hypothetical future needs\n   372→[DONT_MODIFY_DB]: Never modify Supabase tables without explicit instruction\n   373→\n   374→---\n   375→\n   376→## RELATED_DOCUMENTATION\n   377→\n   378→[PROJECT_ROOT]: C:\\Users\\Split Lease\\Documents\\Split Lease\\.claude\\CLAUDE.md\n   379→[SOURCE_CODE]: C:\\Users\\Split Lease\\Documents\\Split Lease\\app\\src\\CLAUDE.md\n   380→[SUPABASE]: C:\\Users\\Split Lease\\Documents\\Split Lease\\supabase\\CLAUDE.md\n   381→[DATABASE_SCHEMA]: C:\\Users\\Split Lease\\Documents\\Split Lease\\DATABASE_SCHEMA_OVERVIEW.md\n   382→[ROUTING_GUIDE]: C:\\Users\\Split Lease\\Documents\\Split Lease\\.claude\\Documentation\\Routing\\ROUTING_GUIDE.md\n   383→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"parent_tool_use_id":null,"session_id":"89fa3960-4abe-4bb1-80c9-368fdaf7240c","uuid":"cfedd366-e40a-4932-aa80-11766f48939c","tool_use_result":{"type":"text","file":{"filePath":"C:\\Users\\Split Lease\\Documents\\Split Lease\\app\\CLAUDE.md","content":"# App Directory - LLM Reference\n\n**GENERATED**: 2025-12-11\n**SCOPE**: Frontend application root - Configuration, build tools, static assets, entry points\n**OPTIMIZATION**: Semantic Searchability + Digestibility\n\n---\n\n## QUICK_STATS\n\n[TOTAL_ROOT_FILES]: 9\n[TOTAL_SUBDIRECTORIES]: 6\n[PRIMARY_LANGUAGE]: JavaScript/TypeScript (React 18)\n[BUILD_TOOL]: Vite 5.0\n[ARCHITECTURE]: Islands Architecture\n[DEPLOYMENT]: Cloudflare Pages\n[KEY_PATTERNS]: Multi-page app, Route Registry, Islands pattern, ESM modules\n\n---\n\n## ROOT_FILES\n\n### package.json\n[INTENT]: NPM package configuration and dependency management\n[TYPE]: ESM module (type: \"module\")\n[SCRIPTS]: dev (port 8000), build, preview, generate-routes, prebuild\n[DEPENDENCIES]: React 18, Supabase client, Google Maps React, date-fns, framer-motion, react-hook-form, zod, styled-components\n[DEV_DEPENDENCIES]: Vite 5, @vitejs/plugin-react, esbuild, supabase CLI\n[RUNTIME]: Bun preferred, Node compatible\n\n### vite.config.js\n[INTENT]: Vite bundler configuration for multi-page React application\n[PLUGINS]: @vitejs/plugin-react, multi-page-routing middleware, move-html-to-root post-build\n[ROUTING_LOGIC]: Shared routing function for dev and preview servers using Route Registry\n[BUILD_INPUT]: 27 HTML entry points from public/ directory\n[BUILD_OUTPUT]: dist/ with HTML at root, assets in dist/assets/\n[DEV_SERVER]: Port 8000, localhost + 127.0.0.1, /api proxy to wrangler (port 8788)\n[PREVIEW_SERVER]: Port 8000, 127.0.0.1\n[POST_BUILD_TASKS]: Move HTML to dist root, copy assets/, copy _redirects, copy _headers, copy _routes.json, create _internal/ files, copy images/, copy help-center-articles/, copy functions/\n[IMPORTS]: routes, getInternalRoutes, getBasePath, buildRollupInputs from src/routes.config.js\n\n### tsconfig.json\n[INTENT]: TypeScript compiler configuration for React app\n[TARGET]: ES2020\n[MODULE]: ESNext\n[JSX]: react-jsx\n[MODE]: Bundler mode resolution\n[STRICT]: Disabled (strict: false)\n[INCLUDE]: src directory\n[ALLOW_JS]: true\n[NO_EMIT]: true (type checking only, Vite handles compilation)\n\n### tsconfig.node.json\n[INTENT]: TypeScript configuration for Node.js scripts\n[COMPOSITE]: true\n[MODULE]: ESNext\n[INCLUDE]: vite.config.js\n\n### .env.example\n[INTENT]: Environment variable template for local development\n[REQUIRED_VARS]: VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY, VITE_GOOGLE_MAPS_API_KEY\n[OPTIONAL_VARS]: SLACK_WEBHOOK_ACQUISITION, SLACK_WEBHOOK_GENERAL\n[REMOVED_VARS]: VITE_BUBBLE_API_BASE_URL, VITE_BUBBLE_API_KEY (migrated to Edge Functions)\n[SECURITY_NOTE]: Bubble API keys now stored server-side in Supabase Secrets\n\n### .gitignore\n[INTENT]: Git ignore patterns\n[IGNORED]: node_modules/, dist/, .env, .env.local, *.log, .DS_Store, ../input\n\n### bun.lock\n[INTENT]: Bun package manager lockfile\n[PURPOSE]: Reproducible dependency installation\n\n### .gitkeep-functions\n[INTENT]: Placeholder to keep functions directory in git\n\n---\n\n## SUBDIRECTORIES\n\n### src/\n[INTENT]: React application source code\n[CONTAINS]: Entry points (*.jsx), islands/, lib/, logic/, styles/, routes/, config/, data/\n[ARCHITECTURE]: Islands Architecture with hollow components\n[DOCUMENTATION]: C:\\Users\\Split Lease\\Documents\\Split Lease\\app\\src\\CLAUDE.md\n[ENTRY_POINTS]: 27 JSX files that mount React components to HTML pages\n[KEY_SUBDIRS]: islands/ (React components), lib/ (utilities + API clients), logic/ (4-layer business logic), styles/ (CSS)\n\n### public/\n[INTENT]: Static assets and HTML templates for multi-page app\n[CONTAINS]: HTML files, assets/, images/, help-center-articles/, _redirects, _headers, _routes.json\n[HTML_FILES]: 27 files (index.html, search.html, view-split-lease.html, etc.)\n[DEPLOYMENT_FILES]: _redirects (Cloudflare routing), _headers (HTTP headers), _routes.json (Functions control)\n[GENERATED_FILES]: _redirects and _routes.json are auto-generated by scripts/generate-redirects.js\n[COPY_BEHAVIOR]: Assets copied to dist/ during build, HTML files moved to dist root\n\n### public/assets/\n[INTENT]: Static media assets\n[SUBDIRS]: fonts/, games/, icons/, images/, lotties/, resources/, videos/\n[USAGE]: Referenced via /assets/ path in HTML/CSS\n\n### public/images/\n[INTENT]: Public image files\n[CONTAINS]: support-centre-icon.svg\n[USAGE]: Referenced via /images/ path\n\n### public/help-center-articles/\n[INTENT]: Static HTML help articles\n[USAGE]: Served directly by Cloudflare Pages\n\n### scripts/\n[INTENT]: Build and development scripts\n[FILES]: generate-redirects.js\n[USAGE]: Executed via npm/bun scripts (prebuild hook)\n\n### functions/\n[INTENT]: Cloudflare Pages Functions (API routes)\n[SUBDIRS]: api/\n[FILES]: api/faq-inquiry.js\n[DEPLOYMENT]: Automatically deployed to /api/* routes on Cloudflare Pages\n[NOTE]: Most backend logic now uses Supabase Edge Functions, not Cloudflare Functions\n\n### functions/api/\n[INTENT]: Cloudflare Pages API endpoints\n[FILES]: faq-inquiry.js, CLAUDE.md\n[ROUTES]: /api/faq-inquiry\n[STATUS]: Deprecated in favor of Supabase Edge Functions\n\n### dist/\n[INTENT]: Production build output (generated, not in git)\n[STRUCTURE]: HTML at root, assets/ subdir, _internal/ subdir, functions/ copy\n[CREATED_BY]: vite build command\n[DEPLOYMENT_TARGET]: Cloudflare Pages\n\n---\n\n## ROUTING_SYSTEM\n\n### src/routes.config.js\n[INTENT]: Single source of truth for all application routes\n[EXPORTS]: routes array, apiRoutes, excludedFromFunctions, getInternalRoutes(), getBasePath(), matchRoute(), findRouteForUrl(), buildRollupInputs()\n[ROUTE_COUNT]: 27 routes\n[ROUTE_TYPES]: Static pages, dynamic routes (:id, :userId, :category), protected routes, dev-only routes\n[DYNAMIC_ROUTES]: /view-split-lease/:id, /preview-split-lease/:id, /guest-proposals/:userId, /account-profile/:userId, /host-proposals/:userId, /help-center/:category\n[PROTECTED_ROUTES]: /preview-split-lease, /guest-proposals, /account-profile, /host-proposals, /self-listing, /listing-dashboard, /host-overview, /favorite-listings, /rental-application\n[CLOUDFLARE_INTERNAL]: Routes using _internal/ directory to avoid 308 redirects\n[USAGE]: Consumed by vite.config.js, scripts/generate-redirects.js\n\n### scripts/generate-redirects.js\n[INTENT]: Generate Cloudflare Pages routing files from Route Registry\n[EXECUTION]: prebuild hook (bun run generate-routes)\n[GENERATES]: public/_redirects, public/_routes.json\n[INPUT]: src/routes.config.js\n[VALIDATION]: Checks for duplicate paths, missing fields, cloudflareInternal consistency\n[OUTPUT_FORMAT]: _redirects (Cloudflare rewrite syntax), _routes.json (Functions control)\n\n### public/_redirects\n[INTENT]: Cloudflare Pages routing configuration\n[GENERATED_BY]: scripts/generate-redirects.js\n[SYNTAX]: Cloudflare Pages redirects format\n[PATTERN]: path /_internal/name 200 OR path /file.html 200\n[DYNAMIC_HANDLING]: Use _internal/ files to prevent Cloudflare's 308 redirects\n[AUTO_GENERATED]: DO NOT EDIT MANUALLY\n\n### public/_routes.json\n[INTENT]: Control which routes use Cloudflare Functions\n[GENERATED_BY]: scripts/generate-redirects.js\n[INCLUDE]: /api/* (Cloudflare Functions)\n[EXCLUDE]: /guest-proposals, /guest-proposals/*, /host-proposals, /host-proposals/*\n[VERSION]: 1\n\n---\n\n## BUILD_PROCESS\n\n### Development\n[COMMAND]: bun run dev\n[PORT]: 8000\n[SERVER]: Vite dev server with HMR\n[MIDDLEWARE]: Multi-page routing middleware using Route Registry\n[PUBLIC_PREFIX]: /public (proxied to public/ directory)\n[API_PROXY]: /api/* proxied to localhost:8788 (wrangler)\n\n### Production Build\n[COMMAND]: bun run build\n[STEPS]: 1) Prebuild (generate routes), 2) Vite build, 3) Post-build (move HTML, copy assets)\n[OUTPUT]: dist/ directory\n[HTML_LOCATION]: dist root (e.g., dist/index.html)\n[ASSETS_LOCATION]: dist/assets/ with hashed filenames\n[INTERNAL_FILES]: dist/_internal/ (copies of HTML files for Cloudflare routing)\n[COPIED_DIRS]: assets/, images/, help-center-articles/, functions/\n[COPIED_FILES]: _redirects, _headers, _routes.json\n\n### Preview\n[COMMAND]: bun run preview\n[PORT]: 8000\n[SERVER]: Vite preview server (serves dist/)\n[MIDDLEWARE]: Multi-page routing middleware using Route Registry\n[PUBLIC_PREFIX]: Empty string (serves from dist root)\n\n---\n\n## DEPLOYMENT\n\n### Platform\n[TARGET]: Cloudflare Pages\n[BUILD_COMMAND]: bun run build\n[OUTPUT_DIR]: dist\n[NODE_VERSION]: 18 or higher\n[FRAMEWORK_PRESET]: None (custom Vite config)\n\n### Routing Strategy\n[METHOD]: Cloudflare _redirects file + _internal directory\n[WHY_INTERNAL]: Avoid Cloudflare's \"pretty URL\" 308 redirects that strip query params/hash\n[DYNAMIC_ROUTES]: Rewrite to _internal/route-name files\n[STATIC_ROUTES]: Some use _internal/, some direct to .html\n\n### Functions\n[CLOUDFLARE_FUNCTIONS]: /api/* (legacy, deprecated)\n[SUPABASE_EDGE_FUNCTIONS]: Preferred for all backend logic\n[EXCLUDED_ROUTES]: /guest-proposals/*, /host-proposals/* (no Functions processing)\n\n---\n\n## ENTRY_POINTS\n\n### HTML Templates (public/*.html)\n[COUNT]: 27 files\n[PURPOSE]: Shell pages that load React apps\n[PATTERN]: <div id=\"root\"></div> + <script type=\"module\" src=\"/src/ENTRY.jsx\"></script>\n[BUILD_BEHAVIOR]: Vite processes, outputs to dist root with hashed asset references\n\n### React Entry Points (src/*.jsx)\n[COUNT]: 27 files\n[PATTERN]: Import page component, createRoot, render to #root\n[EXAMPLES]: main.jsx → HomePage, search.jsx → SearchPage, view-split-lease.jsx → ViewSplitLeasePage\n\n### Entry Point Mapping\n[HOMEPAGE]: index.html ← src/main.jsx ← HomePage\n[SEARCH]: search.html ← src/search.jsx ← SearchPage\n[LISTING_VIEW]: view-split-lease.html ← src/view-split-lease.jsx ← ViewSplitLeasePage\n[LISTING_PREVIEW]: preview-split-lease.html ← src/preview-split-lease.jsx ← PreviewSplitLeasePage\n[GUEST_PROPOSALS]: guest-proposals.html ← src/guest-proposals.jsx ← GuestProposalsPage\n[HOST_PROPOSALS]: host-proposals.html ← src/host-proposals.jsx ← HostProposalsPage\n[SELF_LISTING]: self-listing.html ← src/self-listing.jsx ← SelfListingPage\n[SELF_LISTING_V2]: self-listing-v2.html ← src/self-listing-v2.jsx ← SelfListingPageV2\n[LISTING_DASHBOARD]: listing-dashboard.html ← src/listing-dashboard.jsx ← ListingDashboardPage\n[HOST_OVERVIEW]: host-overview.html ← src/host-overview.jsx ← HostOverviewPage\n[ACCOUNT_PROFILE]: account-profile.html ← src/account-profile.jsx ← AccountProfilePage\n[FAQ]: faq.html ← src/faq.jsx ← FAQPage\n[HELP_CENTER]: help-center.html ← src/help-center.jsx ← HelpCenterPage\n[HELP_CATEGORY]: help-center-category.html ← src/help-center-category.jsx ← HelpCenterCategoryPage\n[POLICIES]: policies.html ← src/policies.jsx ← PoliciesPage\n[CAREERS]: careers.html ← src/careers.jsx ← CareersPage\n[ABOUT_US]: about-us.html ← src/about-us.jsx ← AboutUsPage\n[LIST_WITH_US]: list-with-us.html ← src/list-with-us.jsx ← ListWithUsPage\n[WHY_SPLIT_LEASE]: why-split-lease.html ← src/why-split-lease.jsx ← WhySplitLeasePage\n[GUEST_SUCCESS]: guest-success.html ← src/guest-success.jsx ← GuestSuccessPage\n[HOST_SUCCESS]: host-success.html ← src/host-success.jsx ← HostSuccessPage\n[FAVORITE_LISTINGS]: favorite-listings.html ← src/favorite-listings.jsx ← FavoriteListingsPage\n[RENTAL_APPLICATION]: rental-application.html ← src/rental-application.jsx ← RentalApplicationPage\n[RESET_PASSWORD]: reset-password.html ← src/reset-password.jsx ← ResetPasswordPage\n[NOT_FOUND]: 404.html ← src/404.jsx ← NotFoundPage\n[SEARCH_TEST]: search-test.html ← src/search-test.jsx ← SearchPageTest\n[INTERNAL_TEST]: _internal-test.html ← src/_internal-test.jsx ← InternalTestPage\n\n---\n\n## ARCHITECTURE_PATTERNS\n\n### Islands Architecture\n[DESCRIPTION]: Each HTML page is an independent React root\n[BENEFIT]: No shared state between pages, simpler mental model\n[NAVIGATION]: Full page loads (no client-side routing)\n[STATE_PERSISTENCE]: URL params, localStorage, Supabase database\n\n### Route Registry Pattern\n[DESCRIPTION]: Single source of truth for all routes in src/routes.config.js\n[CONSUMERS]: Vite dev server, Vite preview, Cloudflare _redirects, Vite build inputs\n[BENEFIT]: Change route once, updates everywhere\n[VALIDATION]: Automated checks in generate-redirects.js\n\n### Cloudflare _internal Pattern\n[DESCRIPTION]: Copy HTML files to dist/_internal/ with custom names\n[WHY]: Avoid Cloudflare's automatic 308 redirects that strip query params/hash\n[USAGE]: Dynamic routes and pages needing query/hash preservation\n[EXAMPLE]: /search → /_internal/search-view\n\n### Hollow Component Pattern\n[DESCRIPTION]: Page components delegate all logic to custom hooks\n[BENEFIT]: Testable business logic, focused UI components\n[LOCATION]: src/islands/pages/\n[EXAMPLE]: ViewSplitLeasePage.jsx (UI only) + useViewSplitLeasePageLogic.js (logic)\n\n### Four-Layer Logic Architecture\n[DESCRIPTION]: Business logic separated into calculators, rules, processors, workflows\n[LOCATION]: src/logic/\n[LAYER_1]: Calculators (pure math functions: calculate*, get*)\n[LAYER_2]: Rules (boolean predicates: can*, is*, has*, should*)\n[LAYER_3]: Processors (data transformation: adapt*, extract*, process*, format*)\n[LAYER_4]: Workflows (orchestration: *Workflow)\n[BENEFIT]: Reusable, testable, maintainable business logic\n\n---\n\n## ENVIRONMENT_VARIABLES\n\n### Frontend (VITE_ prefix)\n[VITE_SUPABASE_URL]: Supabase project URL (from Supabase dashboard)\n[VITE_SUPABASE_ANON_KEY]: Supabase anonymous key (public, safe for client)\n[VITE_GOOGLE_MAPS_API_KEY]: Google Maps JavaScript API key\n\n### Backend (Supabase Secrets)\n[BUBBLE_API_BASE_URL]: Bubble.io API endpoint (legacy backend)\n[BUBBLE_API_KEY]: Bubble.io API authentication\n[OPENAI_API_KEY]: OpenAI API for AI features\n[SUPABASE_SERVICE_ROLE_KEY]: Supabase admin key (server-side only)\n\n### Configuration Location\n[FRONTEND_ENV]: app/.env (local), Cloudflare Pages settings (production)\n[BACKEND_SECRETS]: Supabase Dashboard → Project Settings → Edge Functions Secrets\n[SECURITY]: Never expose Bubble/OpenAI keys in frontend code\n\n---\n\n## CRITICAL_CONVENTIONS\n\n### Day Indexing\n[JS_FORMAT]: 0-6 (Sunday=0, Monday=1, ..., Saturday=6)\n[BUBBLE_FORMAT]: 1-7 (Sunday=1, Monday=2, ..., Saturday=7)\n[CONVERSION_FUNCTIONS]: adaptDaysFromBubble(), adaptDaysToBubble()\n[LOCATION]: src/logic/processors/external/\n[RULE]: Always convert at API boundaries, never mix formats\n\n### Unique ID Generation\n[METHOD]: Supabase RPC function generate_bubble_id\n[USAGE]: const { data: newId } = await supabaseAdmin.rpc('generate_bubble_id')\n[FORMAT]: 17-character alphanumeric string (Bubble-compatible)\n\n### API Architecture\n[FRONTEND_TO_BACKEND]: Frontend → Supabase Edge Functions → Bubble API\n[DIRECT_SUPABASE]: Frontend → Supabase Database (for Supabase-native tables)\n[NEVER]: Frontend → Bubble API directly (security violation)\n\n---\n\n## DO_RULES\n\n[DO_USE_ROUTE_REGISTRY]: Always update src/routes.config.js for route changes\n[DO_GENERATE_ROUTES]: Run bun run generate-routes after route config changes\n[DO_USE_EDGE_FUNCTIONS]: Proxy all Bubble API calls through Supabase Edge Functions\n[DO_STORE_SECRETS]: Keep API keys in Supabase Secrets, never in frontend\n[DO_COMMIT_CHANGES]: Git commit after each logical change (per project instructions)\n[DO_USE_ESM]: Use ES modules (import/export), not CommonJS\n[DO_USE_BUN]: Prefer bun for package management and script execution\n[DO_USE_HOLLOW_PATTERN]: Keep page components minimal, delegate logic to hooks\n[DO_USE_FOUR_LAYERS]: Organize business logic into calculators/rules/processors/workflows\n[DO_CONVERT_DAYS]: Use adaptDaysFromBubble/adaptDaysToBubble at API boundaries\n\n---\n\n## DONT_RULES\n\n[DONT_EDIT_GENERATED]: Never manually edit _redirects or _routes.json (auto-generated)\n[DONT_EXPOSE_KEYS]: Never put Bubble/OpenAI API keys in frontend code or .env\n[DONT_SKIP_VALIDATION]: Always run generate-redirects.js validation before deploying\n[DONT_CALL_BUBBLE_DIRECTLY]: Never call Bubble API from frontend (security risk)\n[DONT_MIX_DAY_FORMATS]: Never use 0-based and 1-based days in same function\n[DONT_PUSH_FORCE]: Never git push --force to main/master\n[DONT_ADD_FALLBACKS]: No fallback mechanisms when encountering errors (per project philosophy)\n[DONT_OVER_ENGINEER]: Match solution to actual scale, not hypothetical future needs\n[DONT_MODIFY_DB]: Never modify Supabase tables without explicit instruction\n\n---\n\n## RELATED_DOCUMENTATION\n\n[PROJECT_ROOT]: C:\\Users\\Split Lease\\Documents\\Split Lease\\.claude\\CLAUDE.md\n[SOURCE_CODE]: C:\\Users\\Split Lease\\Documents\\Split Lease\\app\\src\\CLAUDE.md\n[SUPABASE]: C:\\Users\\Split Lease\\Documents\\Split Lease\\supabase\\CLAUDE.md\n[DATABASE_SCHEMA]: C:\\Users\\Split Lease\\Documents\\Split Lease\\DATABASE_SCHEMA_OVERVIEW.md\n[ROUTING_GUIDE]: C:\\Users\\Split Lease\\Documents\\Split Lease\\.claude\\Documentation\\Routing\\ROUTING_GUIDE.md\n","numLines":383,"startLine":1,"totalLines":383}}}
